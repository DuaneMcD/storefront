import{a as e,o as u,b as i,w as s,g as t,e as d,B as l}from"./runtime-core.esm-bundler.e6808e6c.js";const c={class:"markdown-body"},h=t("blockquote",null,[t("p",null,[l("Permissions, validation, and the API\u2019s "),t("code",null,"filter"),l(" parameter all rely on a specific JSON structure to define their rules. This page describes the syntax for creating flat, relational, or complex filter rules.")])],-1),p=t("p",null,[t("div",{class:"table-of-contents"},[t("ul",null,[t("li",null,[t("a",{href:"#syntax"},"Syntax")]),t("li",null,[t("a",{href:"#filter-operators"},"Filter Operators")]),t("li",null,[t("a",{href:"#relational"},"Relational")]),t("li",null,[t("a",{href:"#logical-operators"},"Logical Operators")]),t("li",null,[t("a",{href:"#dynamic-variables"},"Dynamic Variables")])])])],-1),_=t("h2",{id:"syntax"},[l("Syntax "),t("a",{class:"header-anchor",href:"#syntax"},"#")],-1),f=t("ul",null,[t("li",null,[t("strong",null,"Field"),l(" \u2014 Any valid root field, "),t("a",{href:"#relational"},"relational field"),l(", or "),t("a",{href:"#logical-operators"},"logical operator")]),t("li",null,[t("strong",null,"Operator"),l(" \u2014 Any valid "),t("a",{href:"#filter-operators"},"filter operator")]),t("li",null,[t("strong",null,"Value"),l(" \u2014 Any valid static value, or "),t("a",{href:"#dynamic-variables"},"dynamic variable")])],-1),g=t("pre",null,[t("code",null,`{
	<field>: {
		<operator>: <value>
	}
}
`)],-1),m=t("h3",{id:"examples"},[l("Examples "),t("a",{class:"header-anchor",href:"#examples"},"#")],-1),y=t("pre",null,[t("code",{class:"language-json"},[l(`{
	`),t("span",{class:"hljs-attr"},'"title"'),l(`: {
		`),t("span",{class:"hljs-attr"},'"_contains"'),l(": "),t("span",{class:"hljs-string"},'"Directus"'),l(`
	}
}
`)])],-1),b=t("pre",null,[t("code",{class:"language-json"},[l(`{
	`),t("span",{class:"hljs-attr"},'"owner"'),l(`: {
		`),t("span",{class:"hljs-attr"},'"_eq"'),l(": "),t("span",{class:"hljs-string"},'"$CURRENT_USER"'),l(`
	}
}
`)])],-1),v=t("pre",null,[t("code",{class:"language-json"},[l(`{
	`),t("span",{class:"hljs-attr"},'"datetime"'),l(`: {
		`),t("span",{class:"hljs-attr"},'"_lte"'),l(": "),t("span",{class:"hljs-string"},'"$NOW"'),l(`
	}
}
`)])],-1),j=t("h2",{id:"filter-operators"},[l("Filter Operators "),t("a",{class:"header-anchor",href:"#filter-operators"},"#")],-1),R=t("table",null,[t("thead",null,[t("tr",null,[t("th",null,[l("Operator Title "),t("em",null,"(in app)")]),t("th",null,"Operator"),t("th",null,"Description")])]),t("tbody",null,[t("tr",null,[t("td",null,"Equals"),t("td",null,[t("code",null,"_eq")]),t("td",null,"Equal to")]),t("tr",null,[t("td",null,"Doesn\u2019t equal"),t("td",null,[t("code",null,"_neq")]),t("td",null,"Not equal to")]),t("tr",null,[t("td",null,"Less than"),t("td",null,[t("code",null,"_lt")]),t("td",null,"Less than")]),t("tr",null,[t("td",null,"Less than or equal to"),t("td",null,[t("code",null,"_lte")]),t("td",null,"Less than or equal to")]),t("tr",null,[t("td",null,"Greater than"),t("td",null,[t("code",null,"_gt")]),t("td",null,"Greater than")]),t("tr",null,[t("td",null,"Greater than or equal to"),t("td",null,[t("code",null,"_gte")]),t("td",null,"Greater than or equal to")]),t("tr",null,[t("td",null,"Is one of"),t("td",null,[t("code",null,"_in")]),t("td",null,"Matches any of the values")]),t("tr",null,[t("td",null,"Is not one of"),t("td",null,[t("code",null,"_nin")]),t("td",null,"Doesn\u2019t match any of the values")]),t("tr",null,[t("td",null,"Is null"),t("td",null,[t("code",null,"_null")]),t("td",null,[l("Is "),t("code",null,"null")])]),t("tr",null,[t("td",null,"Isn\u2019t null"),t("td",null,[t("code",null,"_nnull")]),t("td",null,[l("Is not "),t("code",null,"null")])]),t("tr",null,[t("td",null,"Contains"),t("td",null,[t("code",null,"_contains")]),t("td",null,"Contains the substring")]),t("tr",null,[t("td",null,"Doesn\u2019t contain"),t("td",null,[t("code",null,"_ncontains")]),t("td",null,"Doesn\u2019t contain the substring")]),t("tr",null,[t("td",null,"Starts with"),t("td",null,[t("code",null,"_starts_with")]),t("td",null,"Starts with")]),t("tr",null,[t("td",null,"Doesn\u2019t start with"),t("td",null,[t("code",null,"_nstarts_with")]),t("td",null,"Doesn\u2019t start with")]),t("tr",null,[t("td",null,"Ends with"),t("td",null,[t("code",null,"_ends_with")]),t("td",null,"Ends with")]),t("tr",null,[t("td",null,"Doesn\u2019t end with"),t("td",null,[t("code",null,"_nends_with")]),t("td",null,"Doesn\u2019t end with")]),t("tr",null,[t("td",null,"Is between"),t("td",null,[t("code",null,"_between")]),t("td",null,"Is between two values (inclusive)")]),t("tr",null,[t("td",null,"Isn\u2019t between"),t("td",null,[t("code",null,"_nbetween")]),t("td",null,"Is not between two values (inclusive)")]),t("tr",null,[t("td",null,"Is empty"),t("td",null,[t("code",null,"_empty")]),t("td",null,[l("Is empty ("),t("code",null,"null"),l(" or falsy)")])]),t("tr",null,[t("td",null,"Isn\u2019t empty"),t("td",null,[t("code",null,"_nempty")]),t("td",null,[l("Is not empty ("),t("code",null,"null"),l(" or falsy)")])]),t("tr",null,[t("td",null,"Intersects"),t("td",null,[t("code",null,"_intersects"),l(),t("sup",null,"[1]")]),t("td",null,"Value intersects a given point")]),t("tr",null,[t("td",null,"Doesn\u2019t intersect"),t("td",null,[t("code",null,"_nintersects"),l(),t("sup",null,"[1]")]),t("td",null,"Value does not intersect a given point")]),t("tr",null,[t("td",null,"Intersects Bounding box"),t("td",null,[t("code",null,"_intersects_bbox"),l(),t("sup",null,"[1]")]),t("td",null,"Value is in a bounding box")]),t("tr",null,[t("td",null,"Doesn\u2019t intersect bounding box"),t("td",null,[t("code",null,"_nintersects_bbox"),l(),t("sup",null,"[1]")]),t("td",null,"Value is not in a bounding box")])])],-1),w=t("p",null,[l("The following operator has no Title on the Filter Interface as it is "),t("strong",null,"only available in validation permissions"),l(":")],-1),x=t("table",null,[t("thead",null,[t("tr",null,[t("th",null,"Operator"),t("th",null,"Description")])]),t("tbody",null,[t("tr",null,[t("td",null,[t("code",null,"_regex"),l(),t("sup",null,"[2]")]),t("td",null,"Field has to match regex")])])],-1),E=t("sup",null,"[1]",-1),N=l(" Only available on Geometry types.\\ "),O=t("sup",null,"[2]",-1),I=l(' JavaScript "flavor" regex. Make sure to escape backslashes. '),T=t("h2",{id:"relational"},[l("Relational "),t("a",{class:"header-anchor",href:"#relational"},"#")],-1),q=t("p",null,[l("You can target related values by nesting field names. For example, if you have a relational Many-to-One "),t("code",null,"author"),l(" field, you can set a rule for the "),t("code",null,"author.name"),l(" field using the following syntax.")],-1),D=t("pre",null,[t("code",{class:"language-json"},[l(`{
	`),t("span",{class:"hljs-attr"},'"author"'),l(`: {
		`),t("span",{class:"hljs-attr"},'"name"'),l(`: {
			`),t("span",{class:"hljs-attr"},'"_eq"'),l(": "),t("span",{class:"hljs-string"},'"Rijk van Zanten"'),l(`
		}
	}
}
`)])],-1),U=t("h2",{id:"logical-operators"},[l("Logical Operators "),t("a",{class:"header-anchor",href:"#logical-operators"},"#")],-1),F=t("p",null,[l("You can nest or group multiple rules using the "),t("code",null,"_and"),l(" or "),t("code",null,"_or"),l(" logical operators. Each logical operator holds an array of Filter Rules, allowing for more complex filtering. Also note in the example that Logical Operators can be sub-nested into Logical Operators. However, they cannot be sub-nested into Filter Rules.")],-1),$=t("pre",null,[t("code",{class:"language-json"},[l(`{
	`),t("span",{class:"hljs-attr"},'"_or"'),l(`: [
		{
			`),t("span",{class:"hljs-attr"},'"_and"'),l(`: [
				{
					`),t("span",{class:"hljs-attr"},'"user_created"'),l(`: {
						`),t("span",{class:"hljs-attr"},'"_eq"'),l(": "),t("span",{class:"hljs-string"},'"$CURRENT_USER"'),l(`
					}
				},
				{
					`),t("span",{class:"hljs-attr"},'"status"'),l(`: {
						`),t("span",{class:"hljs-attr"},'"_in"'),l(": ["),t("span",{class:"hljs-string"},'"published"'),l(", "),t("span",{class:"hljs-string"},'"draft"'),l(`]
					}
				}
			]
		},
		{
			`),t("span",{class:"hljs-attr"},'"_and"'),l(`: [
				{
					`),t("span",{class:"hljs-attr"},'"user_created"'),l(`: {
						`),t("span",{class:"hljs-attr"},'"_neq"'),l(": "),t("span",{class:"hljs-string"},'"$CURRENT_USER"'),l(`
					}
				},
				{
					`),t("span",{class:"hljs-attr"},'"status"'),l(`: {
						`),t("span",{class:"hljs-attr"},'"_in"'),l(": ["),t("span",{class:"hljs-string"},'"published"'),l(`]
					}
				}
			]
		}
	]
}
`)])],-1),C=t("h3",{id:"some-vs-none-in-one-to-many"},[l("Some vs None in One-to-Many "),t("a",{class:"header-anchor",href:"#some-vs-none-in-one-to-many"},"#")],-1),S=t("p",null,"When applying filters to a one-to-many field, Directus will default to a \u201Csome\u201D search, for example in:",-1),k=t("pre",null,[t("code",{class:"language-json"},[l(`{
	`),t("span",{class:"hljs-attr"},'"categories"'),l(`: {
		`),t("span",{class:"hljs-attr"},'"name"'),l(`: {
			`),t("span",{class:"hljs-attr"},'"_eq"'),l(": "),t("span",{class:"hljs-string"},'"Recipe"'),l(`
		}
	}
}
`)])],-1),L=t("p",null,[l("the top level parent will be returned if "),t("em",null,"one of"),l(" the categories has the name "),t("code",null,"Recipe"),l(". This behavior can be overridden by using the explicit "),t("code",null,"_some"),l(" and "),t("code",null,"_none"),l(" operators, for example:")],-1),V=t("pre",null,[t("code",{class:"language-json"},[l(`{
	`),t("span",{class:"hljs-attr"},'"categories"'),l(`: {
		`),t("span",{class:"hljs-attr"},'"_none"'),l(`: {
			`),t("span",{class:"hljs-attr"},'"name"'),l(`: {
				`),t("span",{class:"hljs-attr"},'"_eq"'),l(": "),t("span",{class:"hljs-string"},'"Recipe"'),l(`
			}
		}
	}
}
`)])],-1),W=t("p",null,"will fetch all parent items that don\u2019t have the category \u201CRecipe\u201D",-1),A=t("h2",{id:"dynamic-variables"},[l("Dynamic Variables "),t("a",{class:"header-anchor",href:"#dynamic-variables"},"#")],-1),B=t("p",null,[l("In addition to static values, you can also filter against "),t("em",null,"dynamic"),l(" values using the following variables.")],-1),G=t("ul",null,[t("li",null,[t("code",null,"$CURRENT_USER"),l(" \u2014 The primary key of the currently authenticated user")]),t("li",null,[t("code",null,"$CURRENT_ROLE"),l(" \u2014 The primary key of the role for the currently authenticated user")]),t("li",null,[t("code",null,"$NOW"),l(" \u2014 The current timestamp")]),t("li",null,[t("code",null,"$NOW(<adjustment>)"),l(" - The current timestamp plus/minus a given distance, for example "),t("code",null,"$NOW(-1 year)"),l(", "),t("code",null,"$NOW(+2 hours)")])],-1),M={class:"tip hint"},P=t("div",{class:"hint-title"},"Functions",-1),Y=l("You can also use "),J=l("Function Parameters"),z=l(" when building Filters."),H=t("div",{class:"tip hint"},[t("div",{class:"hint-title"},"Nested User / Role variables in Permissions"),t("p",null,[l("When configuring permissions, "),t("code",null,"$CURRENT_USER"),l(" and "),t("code",null,"$CURRENT_ROLE"),l(" allow you to specify any (nested) field under the current user/role as well as the root ID. For example: "),t("code",null,"$CURRENT_ROLE.name"),l(" or "),t("code",null,"$CURRENT_USER.avatar.filesize"),l(". This includes custom fields that were added to the directus_users/directus_roles tables.")]),t("p",null,"Note: This feature is only available for permissions, validation, and presets. Regular filters and conditional fields currently only support the root ID.")],-1),tt="Filter Rules",lt=!1,nt={name:"filter-rules",setup(Z,{expose:a}){const n={title:"Filter Rules",modularExtension:!1};return a({frontmatter:n}),(K,Q)=>{const o=e("router-link"),r=e("docs-wrapper");return u(),i(r,{frontmatter:n},{default:s(()=>[t("div",c,[h,p,_,f,g,m,y,b,v,j,R,w,x,E,N,O,I,T,q,D,U,F,$,C,S,k,L,V,W,A,B,G,t("div",M,[P,t("p",null,[Y,d(o,{to:"/docs/reference/query/#functions"},{default:s(()=>[J]),_:1}),z])]),H])]),_:1})}}};export{nt as default,lt as modularExtension,tt as title};
